# 영속성 컨텍스트
데이터베이스의 데이터는 영속성을 가진다.  
JPA는 데이터베이스와 데이터를 주고 받는 과정에서 영속성 컨텍스트라는 것을 만든다.  
JPA는 실제로 가상 영속성 컨텍스트와 대화를 하고 데이터베이스도 영속성 컨텍스트와 대화를 한다.  
데이터베이스에서 조횐한 데이터는 영속성 컨텍스트에서 관리하여, 

영속성 컨텍스트는 JPA의 데이터가 데이터베이스로 가기 전 먼저 처리를 해서 몇가지 특징들을 가질 수 있게 해준다.  
상황에 따라 데이터베이스와 직접 소통하는 대신 관리하고 있는 ENTITY 객체를 활용한다.  
1. 1차 캐시
    한번의 트랜젝션이 일어날 때, 한번 조회하거나 저장된 데이터는 영속성 컨텍스트에 내부에 저장되므로, 같은데이터를여러번 조회하거나 방금 생성한 데이터의내용을 조회하는 등의 작업이 필요할 때 성능 향상을 기대할 수 있다.

2. 쓰기 지연
    데이터베이스에 데이터를 저장하는 작업은 입출력 작업의 일종이 되며, 이는 비교적 많은 자원을 소모게 됩니다. 영속성 컨택스트는 사용자가 엔티티를 저장하는 시점에 바로 데이터베이스에 INSERT 문을 실행하지 않고, 어떤 순서데로 INSERT가 있었는지 기억했다가 트랜젝션이 마무리 되었을때 한번에 데이터베이스에 반영합니다. 이를 이용해 여러 변경사항을 한번에 적용하여 입출력 작업의 횟수를 줄이고 성능을 향상시킵니다.

3. 변경 감지
    트랜젝션 내부에서 엔티티가 수정되면, 개발자가 직접 수정 사항을 저장하지 않아도, 트랜젝션이 마무리 되는 시점에 자동으로 차이점을 확인해서 반영을 해줍니다. 저희가 특정 엔티티를 수정하는 과정에서 데이터베이스에서 데이터를 조회하면 해당 엔티티가 영속성 컨텍스트에 1차 캐시로 저장이 됩니다. 이후 저희 메서드에서 엔티티를 수정하면, 트랜젝션이 마무리 될때 처음 조회했던 상태와 비교를 진행하고, 만약 변경된 내역이 있다면 해당 내용을 반영할 수 있는 UPDATE SQL문이 자동으로 생성되게 됩니다.